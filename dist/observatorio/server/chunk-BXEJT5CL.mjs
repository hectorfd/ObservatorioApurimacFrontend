import './polyfills.server.mjs';
import{c as U,f as P,g as G}from"./chunk-EJZQSUXC.mjs";import"./chunk-ZASAXBQR.mjs";import{f as j,h as z}from"./chunk-G3U6UHYZ.mjs";import{a as J,b as K,c as Q}from"./chunk-MPHLS436.mjs";import{b as B}from"./chunk-HAKE4BKR.mjs";import{c as R}from"./chunk-KKRHTJMI.mjs";import"./chunk-ACR4XYDT.mjs";import"./chunk-24XWOOB4.mjs";import"./chunk-NE3AAHS4.mjs";import{a as k,d as V,e as H,g as q,i as N,j as O,q as W}from"./chunk-PQCZKNIO.mjs";import{o as F}from"./chunk-CGZW3GIW.mjs";import{Cb as c,Dc as T,Eb as p,Ec as L,Hc as I,Nb as l,Ob as M,Pb as C,Qa as y,Rb as g,Sb as h,Ta as o,Tb as b,Ua as E,Vb as A,Wb as D,ea as w,ib as v,kb as _,ma as u,na as f,tb as a,ub as n,vb as s,zb as x}from"./chunk-MZ6UPJ7C.mjs";import"./chunk-VVCT4QZE.mjs";var X=()=>[5,10,25,100];function Y(m,S){if(m&1){let e=x();a(0,"div",27)(1,"div",28),s(2,"img",29),a(3,"div",30)(4,"div",31)(5,"small",32),s(6,"i",33),l(7),n()(),a(8,"a",34),l(9),n(),a(10,"div",35)(11,"p"),l(12),n(),a(13,"div",31)(14,"small",36),c("click",function(){let t=u(e).$implicit,d=p();return f(d.redireccionarEditarEntidadAliada(t.id_entidad_aliada))}),s(15,"i",37),l(16," EDITAR "),n(),a(17,"small",38)(18,"i",39),c("click",function(){let t=u(e).$implicit,d=p();return f(d.eliminarentidad_aliada(t.id_entidad_aliada))}),n(),l(19," ELIMINAR "),n()(),a(20,"div",31)(21,"small",40),c("click",function(){let t=u(e).$implicit,d=p();return f(d.redireccionarDetallesEntidadAliada(t.id_entidad_aliada))}),s(22,"i",41),l(23," VER M\xC1S DETALLES "),n()()()()()()}if(m&2){let e=S.$implicit,i=p();o(2),_("src",i.getImageUrl(e.portada),y),o(5),C(" ",e.fecha_registro,""),o(2),M(e.nombre),o(3),C(" ",e.descripcion," ")}}function Z(m,S){if(m&1){let e=x();a(0,"div",23)(1,"div",42)(2,"h4"),l(3,"No se encontraron infograf\xEDas con los filtros aplicados"),n(),a(4,"button",43),c("click",function(){u(e);let t=p();return f(t.limpiarFiltros())}),l(5,"Ver todas las infograf\xEDas"),n()()()}}var _e=(()=>{class m{constructor(e,i){this.router=e,this.api=i,this.busquedaTitulo="",this.fechaDesde="",this.fechaHasta="",this.entidad_aliada=[],this.allentidad_aliada=[]}redireccionarEditarEntidadAliada(e){this.router.navigate(["/editar-entidad-aliada",e])}redireccionarDetallesEntidadAliada(e){this.router.navigate(["/detalle-entidad-aliada",e])}ngOnInit(){this.cargarentidad_aliada()}cargarentidad_aliada(){this.api.getAllEntidadAliada(1).subscribe({next:e=>{this.entidad_aliada=e,this.allentidad_aliada=e,console.log("entidades cargadas:",this.entidad_aliada)},error:e=>{console.error("Error al cargar infograf\xEDas:",e)}})}getImageUrl(e){return e?e.startsWith("http://")||e.startsWith("https://")?e:encodeURI(`http://localhost:80/API OBSERVATORIO/${e}`):"assets/img/no-image.jpg"}eliminarentidad_aliada(e){confirm("\xBFEst\xE1s seguro de que deseas eliminar esta entidaad aliada?")&&this.api.deleteEntidadAliada(e).subscribe({next:i=>{console.log("entidaad aliada eliminada correctamente"),this.cargarentidad_aliada()},error:i=>{console.error("Error al eliminar la entidad :",i)}})}buscarentidad_aliada(e){e.preventDefault();let i=[...this.allentidad_aliada];if(this.busquedaTitulo&&this.busquedaTitulo.trim()!==""){let t=this.busquedaTitulo.toLowerCase().trim();i=i.filter(d=>d.nombre.toLowerCase().includes(t))}if(this.fechaDesde){let t=new Date(this.fechaDesde);t.setHours(0,0,0,0),i=i.filter(d=>new Date(d.fecha_registro)>=t)}if(this.fechaHasta){let t=new Date(this.fechaHasta);t.setHours(23,59,59,999),i=i.filter(d=>new Date(d.fecha_registro)<=t)}this.entidad_aliada=i}limpiarFiltros(){this.busquedaTitulo="",this.fechaDesde="",this.fechaHasta="",this.entidad_aliada=[...this.allentidad_aliada]}static{this.\u0275fac=function(i){return new(i||m)(E(F),E(B))}}static{this.\u0275cmp=w({type:m,selectors:[["app-lista-entidad-aliada"]],standalone:!0,features:[A],decls:36,vars:9,consts:[["id","wrapper",1,"d-flex"],["id","content-wrapper",1,"d-flex","flex-column","w-100",2,"height","100vh","overflow-y","auto"],["id","content",1,"d-flex","flex-column","w-100"],[1,"container-fluid"],[1,"d-sm-flex","align-items-center","justify-content-between","mb-4"],[1,"h3","mb-0","text-gray-800"],[1,"container-fluid","py-5"],[1,"container"],[1,"container","my-4"],[1,"bg-white","p-4","rounded","shadow-sm",3,"submit"],[1,"input-group","mb-3"],["id","basic-addon1",1,"input-group-text"],[1,"fa","fa-file-alt","text-primary"],["type","text","placeholder","Buscar publicaci\xF3n... (opcional)","aria-label","Buscar publicaci\xF3n...","aria-describedby","basic-addon1","name","busquedaTitulo",1,"form-control",3,"ngModelChange","ngModel"],[1,"row","g-3"],[1,"col-md-4"],["for","fechaDesde",1,"form-label"],["type","date","id","fechaDesde","name","fechaDesde",1,"form-control",3,"ngModelChange","ngModel"],["for","fechaHasta",1,"form-label"],["type","date","id","fechaHasta","name","fechaHasta",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-4","d-flex","align-items-end"],["type","submit",1,"btn","btn-primary","me-2"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"row"],["class","col-lg-4 col-md-6 mb-4",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],["aria-label","Select page",3,"length","pageSize","pageSizeOptions"],[1,"col-lg-4","col-md-6","mb-4"],[1,"package-item","bg-white","mb-2"],["alt","",1,"img-fluid",3,"src"],[1,"p-4"],[1,"d-flex","justify-content-between","mb-3"],[1,"m-0"],[1,"fa","fa-calendar-alt","text-primary","mr-2"],["href","",1,"h5","text-decoration-none"],[1,"border-top","mt-4","pt-4"],["title","EDITAR",1,"m-0",3,"click"],[1,"fa","fa-edit","text-success","mr-2"],["title","ELIMINAR",1,"m-0"],[1,"fas","fa-trash-alt","text-danger",3,"click"],["title","VER M\xC1S DETALLES",1,"m-0",3,"click"],[1,"fa","fa-eye","text-primary","mr-2"],[1,"col-12","text-center","p-5"],[1,"btn","btn-primary","mt-3",3,"click"]],template:function(i,t){i&1&&(a(0,"div",0),s(1,"app-sidebar"),a(2,"div",1)(3,"div",2),s(4,"app-topbar"),a(5,"div",3)(6,"div",4)(7,"h1",5),l(8,"Lista de Entidades"),n()(),a(9,"div",6)(10,"div",7)(11,"div",8)(12,"form",9),c("submit",function(r){return t.buscarentidad_aliada(r)}),a(13,"div",10)(14,"span",11),s(15,"i",12),n(),a(16,"input",13),b("ngModelChange",function(r){return h(t.busquedaTitulo,r)||(t.busquedaTitulo=r),r}),n()(),a(17,"div",14)(18,"div",15)(19,"label",16),l(20,"Desde"),n(),a(21,"input",17),b("ngModelChange",function(r){return h(t.fechaDesde,r)||(t.fechaDesde=r),r}),n()(),a(22,"div",15)(23,"label",18),l(24,"Hasta"),n(),a(25,"input",19),b("ngModelChange",function(r){return h(t.fechaHasta,r)||(t.fechaHasta=r),r}),n()(),a(26,"div",20)(27,"button",21),l(28,"Buscar"),n(),a(29,"button",22),c("click",function(){return t.limpiarFiltros()}),l(30,"Limpiar"),n()()()()(),a(31,"div",23),v(32,Y,24,4,"div",24),n(),v(33,Z,6,0,"div",25),s(34,"mat-paginator",26),n()()()(),s(35,"app-footer"),n()()),i&2&&(o(16),g("ngModel",t.busquedaTitulo),o(5),g("ngModel",t.fechaDesde),o(4),g("ngModel",t.fechaHasta),o(7),_("ngForOf",t.entidad_aliada),o(),_("ngIf",t.entidad_aliada.length===0),o(),_("length",100)("pageSize",10)("pageSizeOptions",D(8,X)))},dependencies:[J,Q,K,R,j,z,U,G,P,I,T,L,W,O,k,V,H,N,q]})}}return m})();export{_e as ListaEntidadAliadaComponent};
