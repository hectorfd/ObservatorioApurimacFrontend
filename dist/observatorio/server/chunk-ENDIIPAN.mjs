import './polyfills.server.mjs';
import{c as U,f as P,g as G}from"./chunk-EJZQSUXC.mjs";import"./chunk-ZASAXBQR.mjs";import{f as R,h as z}from"./chunk-G3U6UHYZ.mjs";import{a as J,b as K,c as Q}from"./chunk-MPHLS436.mjs";import{b as j}from"./chunk-HAKE4BKR.mjs";import{c as B}from"./chunk-KKRHTJMI.mjs";import"./chunk-ACR4XYDT.mjs";import"./chunk-24XWOOB4.mjs";import"./chunk-NE3AAHS4.mjs";import{a as H,d as q,e as V,g as N,i as O,j as W,q as A}from"./chunk-PQCZKNIO.mjs";import{o as k}from"./chunk-CGZW3GIW.mjs";import{Cb as d,Dc as T,Eb as p,Ec as L,Hc as F,Nb as l,Ob as E,Pb as h,Qa as S,Rb as _,Sb as b,Ta as s,Tb as I,Ua as v,Vb as M,Wb as D,ea as C,ib as x,kb as c,ma as g,na as u,tb as i,ub as n,vb as f,zb as w}from"./chunk-MZ6UPJ7C.mjs";import"./chunk-VVCT4QZE.mjs";var X=()=>[5,10,25,100];function Y(m,y){if(m&1){let e=w();i(0,"div",27)(1,"div",28),f(2,"img",29),i(3,"div",30)(4,"div",31)(5,"small",32),f(6,"i",33),l(7),n(),i(8,"small",32),f(9,"i",34),l(10),n()(),i(11,"a",35),l(12),n(),i(13,"div",36)(14,"p"),l(15),n(),i(16,"div",31)(17,"small",37),d("click",function(){let t=g(e).$implicit,o=p();return u(o.redireccionarEditarInfografia(t.id_infografia))}),f(18,"i",38),l(19," EDITAR "),n(),i(20,"small",39)(21,"i",40),d("click",function(){let t=g(e).$implicit,o=p();return u(o.eliminarInfografias(t.id_infografia))}),n(),l(22," ELIMINAR "),n()()()()()()}if(m&2){let e=y.$implicit,a=p();s(2),c("src",a.getImageUrl(e.portada),S),s(5),h(" ",e.lugar,""),s(3),h(" ",e.fecha,""),s(2),E(e.titulo),s(3),h(" ",e.descripcion," ")}}function Z(m,y){if(m&1){let e=w();i(0,"div",23)(1,"div",41)(2,"h4"),l(3,"No se encontraron infograf\xEDas con los filtros aplicados"),n(),i(4,"button",42),d("click",function(){g(e);let t=p();return u(t.limpiarFiltros())}),l(5,"Ver todas las infograf\xEDas"),n()()()}}var ue=(()=>{class m{constructor(e,a){this.router=e,this.api=a,this.busquedaTitulo="",this.fechaDesde="",this.fechaHasta="",this.infografias=[],this.allInfografias=[]}redireccionarEditarInfografia(e){this.router.navigate(["/editar-infografia",e])}ngOnInit(){this.cargarInfografias()}cargarInfografias(){this.api.getAllInfografias(1).subscribe({next:e=>{this.infografias=e,this.allInfografias=e,console.log("Infograf\xEDas cargadas:",this.infografias)},error:e=>{console.error("Error al cargar infograf\xEDas:",e)}})}getImageUrl(e){return e?e.startsWith("http://")||e.startsWith("https://")?e:`http://localhost:80/API OBSERVATORIO/${e}`:"assets/img/no-image.jpg"}eliminarInfografias(e){confirm("\xBFEst\xE1s seguro de que deseas eliminar esta infografia?")&&this.api.deleteInfografia(e).subscribe({next:a=>{console.log("Infografia eliminada correctamente"),this.cargarInfografias()},error:a=>{console.error("Error al eliminar la infografia:",a)}})}buscarInfografias(e){e.preventDefault();let a=[...this.allInfografias];if(this.busquedaTitulo&&this.busquedaTitulo.trim()!==""){let t=this.busquedaTitulo.toLowerCase().trim();a=a.filter(o=>o.titulo.toLowerCase().includes(t))}if(this.fechaDesde){let t=new Date(this.fechaDesde);t.setHours(0,0,0,0),a=a.filter(o=>new Date(o.fecha)>=t)}if(this.fechaHasta){let t=new Date(this.fechaHasta);t.setHours(23,59,59,999),a=a.filter(o=>new Date(o.fecha)<=t)}this.infografias=a,console.log("B\xFAsqueda realizada:",{titulo:this.busquedaTitulo,desde:this.fechaDesde,hasta:this.fechaHasta,resultados:this.infografias.length})}limpiarFiltros(){this.busquedaTitulo="",this.fechaDesde="",this.fechaHasta="",this.infografias=[...this.allInfografias]}static{this.\u0275fac=function(a){return new(a||m)(v(k),v(j))}}static{this.\u0275cmp=C({type:m,selectors:[["app-lista-infografia"]],standalone:!0,features:[M],decls:36,vars:9,consts:[["id","wrapper",1,"d-flex"],["id","content-wrapper",1,"d-flex","flex-column","w-100",2,"height","100vh","overflow-y","auto"],["id","content",1,"d-flex","flex-column","w-100"],[1,"container-fluid"],[1,"d-sm-flex","align-items-center","justify-content-between","mb-4"],[1,"h3","mb-0","text-gray-800"],[1,"container-fluid","py-5"],[1,"container"],[1,"container","my-4"],[1,"bg-white","p-4","rounded","shadow-sm",3,"submit"],[1,"input-group","mb-3"],["id","basic-addon1",1,"input-group-text"],[1,"fa","fa-file-alt","text-primary"],["type","text","placeholder","Buscar publicaci\xF3n... (opcional)","aria-label","Buscar publicaci\xF3n...","aria-describedby","basic-addon1","name","busquedaTitulo",1,"form-control",3,"ngModelChange","ngModel"],[1,"row","g-3"],[1,"col-md-4"],["for","fechaDesde",1,"form-label"],["type","date","id","fechaDesde","name","fechaDesde",1,"form-control",3,"ngModelChange","ngModel"],["for","fechaHasta",1,"form-label"],["type","date","id","fechaHasta","name","fechaHasta",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-4","d-flex","align-items-end"],["type","submit",1,"btn","btn-primary","me-2"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"row"],["class","col-lg-4 col-md-6 mb-4",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],["aria-label","Select page",3,"length","pageSize","pageSizeOptions"],[1,"col-lg-4","col-md-6","mb-4"],[1,"package-item","bg-white","mb-2"],["alt","",1,"img-fluid",3,"src"],[1,"p-4"],[1,"d-flex","justify-content-between","mb-3"],[1,"m-0"],[1,"fa","fa-map-marker-alt","text-primary","mr-2"],[1,"fa","fa-calendar-alt","text-primary","mr-2"],["href","",1,"h5","text-decoration-none"],[1,"border-top","mt-4","pt-4"],["title","EDITAR",1,"m-0",3,"click"],[1,"fa","fa-edit","text-success","mr-2"],["title","ELIMINAR",1,"m-0"],[1,"fas","fa-trash-alt","text-danger",3,"click"],[1,"col-12","text-center","p-5"],[1,"btn","btn-primary","mt-3",3,"click"]],template:function(a,t){a&1&&(i(0,"div",0),f(1,"app-sidebar"),i(2,"div",1)(3,"div",2),f(4,"app-topbar"),i(5,"div",3)(6,"div",4)(7,"h1",5),l(8,"Lista de Infografias"),n()(),i(9,"div",6)(10,"div",7)(11,"div",8)(12,"form",9),d("submit",function(r){return t.buscarInfografias(r)}),i(13,"div",10)(14,"span",11),f(15,"i",12),n(),i(16,"input",13),I("ngModelChange",function(r){return b(t.busquedaTitulo,r)||(t.busquedaTitulo=r),r}),n()(),i(17,"div",14)(18,"div",15)(19,"label",16),l(20,"Desde"),n(),i(21,"input",17),I("ngModelChange",function(r){return b(t.fechaDesde,r)||(t.fechaDesde=r),r}),n()(),i(22,"div",15)(23,"label",18),l(24,"Hasta"),n(),i(25,"input",19),I("ngModelChange",function(r){return b(t.fechaHasta,r)||(t.fechaHasta=r),r}),n()(),i(26,"div",20)(27,"button",21),l(28,"Buscar"),n(),i(29,"button",22),d("click",function(){return t.limpiarFiltros()}),l(30,"Limpiar"),n()()()()(),i(31,"div",23),x(32,Y,23,5,"div",24),n(),x(33,Z,6,0,"div",25),f(34,"mat-paginator",26),n()()(),f(35,"app-footer"),n()()()),a&2&&(s(16),_("ngModel",t.busquedaTitulo),s(5),_("ngModel",t.fechaDesde),s(4),_("ngModel",t.fechaHasta),s(7),c("ngForOf",t.infografias),s(),c("ngIf",t.infografias.length===0),s(),c("length",100)("pageSize",10)("pageSizeOptions",D(8,X)))},dependencies:[J,Q,K,B,R,z,U,G,P,F,T,L,A,W,H,q,V,O,N]})}}return m})();export{ue as ListaInfografiaComponent};
