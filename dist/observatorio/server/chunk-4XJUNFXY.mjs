import './polyfills.server.mjs';
import{c as U,f as P,g as G}from"./chunk-EJZQSUXC.mjs";import"./chunk-ZASAXBQR.mjs";import{f as R,h as z}from"./chunk-G3U6UHYZ.mjs";import{a as J,b as K,c as Q}from"./chunk-MPHLS436.mjs";import{b as j}from"./chunk-HAKE4BKR.mjs";import{c as B}from"./chunk-KKRHTJMI.mjs";import"./chunk-ACR4XYDT.mjs";import"./chunk-24XWOOB4.mjs";import"./chunk-NE3AAHS4.mjs";import{a as k,d as H,e as q,g as N,i as O,j as W,q as A}from"./chunk-PQCZKNIO.mjs";import{o as F}from"./chunk-CGZW3GIW.mjs";import{Cb as u,Dc as D,Eb as c,Ec as I,Hc as L,Nb as l,Ob as M,Pb as v,Qa as S,Rb as _,Sb as b,Ta as s,Tb as x,Ua as C,Vb as E,Wb as T,ea as y,ib as g,kb as p,ma as f,na as h,tb as o,ub as n,vb as m,zb as w}from"./chunk-MZ6UPJ7C.mjs";import"./chunk-VVCT4QZE.mjs";var X=()=>[5,10,25,100];function Y(d,V){if(d&1&&(o(0,"div",41),m(1,"video",42),n()),d&2){let e=c().$implicit,i=c();s(),p("src",i.getImageUrl(e.portada),S)}}function Z(d,V){if(d&1){let e=w();o(0,"div",27)(1,"div",28),g(2,Y,2,1,"div",29),o(3,"div",30)(4,"div",31)(5,"small",32),m(6,"i",33),l(7),n(),o(8,"small",32),m(9,"i",34),l(10),n()(),o(11,"a",35),l(12),n(),o(13,"div",36)(14,"p"),l(15),n(),o(16,"div",31)(17,"small",37),u("click",function(){let t=f(e).$implicit,r=c();return h(r.redireccionarEditarVideo(t.id_video))}),m(18,"i",38),l(19," EDITAR "),n(),o(20,"small",39),u("click",function(){let t=f(e).$implicit,r=c();return h(r.eliminarvideos(t.id_video))}),m(21,"i",40),l(22," ELIMINAR "),n()()()()()()}if(d&2){let e=V.$implicit,i=c();s(2),p("ngIf",i.getImageUrl(e.portada)),s(5),v(" ",e.lugar,""),s(3),v(" ",e.fecha,""),s(2),M(e.titulo),s(3),v(" ",e.descripcion," ")}}function $(d,V){if(d&1){let e=w();o(0,"div",23)(1,"div",43)(2,"h4"),l(3,"No se encontraron videos con los filtros aplicados"),n(),o(4,"button",44),u("click",function(){f(e);let t=c();return h(t.limpiarFiltros())}),l(5,"Ver todos los videos"),n()()()}}var ge=(()=>{class d{constructor(e,i){this.router=e,this.api=i,this.busquedaTitulo="",this.fechaDesde="",this.fechaHasta="",this.videos=[],this.allVideos=[]}redireccionarEditarVideo(e){this.router.navigate(["/editar-video",e])}ngOnInit(){this.cargarVideos()}cargarVideos(){this.api.getAllVideos(1).subscribe({next:e=>{this.videos=e,this.allVideos=e,console.log("Videos cargados:",this.videos)},error:e=>{console.error("Error al cargar videos:",e)}})}getImageUrl(e){return e?e.startsWith("http://")||e.startsWith("https://")?e:`http://localhost:80/API OBSERVATORIO/${e}`:"assets/img/no-image.jpg"}eliminarvideos(e){confirm("\xBFEst\xE1s seguro de que deseas eliminar este video?")&&this.api.deleteVideo(e).subscribe({next:i=>{console.log("Video eliminado correctamente"),this.cargarVideos()},error:i=>{console.error("Error al eliminar el video:",i)}})}buscarVideos(e){e.preventDefault();let i=[...this.allVideos];if(this.busquedaTitulo&&this.busquedaTitulo.trim()!==""){let t=this.busquedaTitulo.toLowerCase().trim();i=i.filter(r=>r.titulo.toLowerCase().includes(t))}if(this.fechaDesde){let t=new Date(this.fechaDesde);t.setHours(0,0,0,0),i=i.filter(r=>new Date(r.fecha)>=t)}if(this.fechaHasta){let t=new Date(this.fechaHasta);t.setHours(23,59,59,999),i=i.filter(r=>new Date(r.fecha)<=t)}this.videos=i,console.log("B\xFAsqueda realizada:",{titulo:this.busquedaTitulo,desde:this.fechaDesde,hasta:this.fechaHasta,resultados:this.videos.length})}limpiarFiltros(){this.busquedaTitulo="",this.fechaDesde="",this.fechaHasta="",this.videos=[...this.allVideos]}static{this.\u0275fac=function(i){return new(i||d)(C(F),C(j))}}static{this.\u0275cmp=y({type:d,selectors:[["app-lista-video"]],standalone:!0,features:[E],decls:36,vars:9,consts:[["id","wrapper",1,"d-flex"],["id","content-wrapper",1,"d-flex","flex-column","w-100",2,"height","100vh","overflow-y","auto"],["id","content",1,"d-flex","flex-column","w-100"],[1,"container-fluid"],[1,"d-sm-flex","align-items-center","justify-content-between","mb-4"],[1,"h3","mb-0","text-gray-800"],[1,"container-fluid","py-5"],[1,"container"],[1,"container","my-4"],[1,"bg-white","p-4","rounded","shadow-sm",3,"submit"],[1,"input-group","mb-3"],["id","basic-addon1",1,"input-group-text"],[1,"fa","fa-file-alt","text-primary"],["type","text","placeholder","Buscar publicaci\xF3n... (opcional)","aria-label","Buscar publicaci\xF3n...","aria-describedby","basic-addon1","name","busquedaTitulo",1,"form-control",3,"ngModelChange","ngModel"],[1,"row","g-3"],[1,"col-md-4"],["for","fechaDesde",1,"form-label"],["type","date","id","fechaDesde","name","fechaDesde",1,"form-control",3,"ngModelChange","ngModel"],["for","fechaHasta",1,"form-label"],["type","date","id","fechaHasta","name","fechaHasta",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-4","d-flex","align-items-end"],["type","submit",1,"btn","btn-primary","me-2"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"row"],["class","col-lg-4 col-md-6 mb-4",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],["aria-label","Select page",3,"length","pageSize","pageSizeOptions"],[1,"col-lg-4","col-md-6","mb-4"],[1,"package-item","bg-white","mb-2"],["class","text-center mb-3",4,"ngIf"],[1,"p-4"],[1,"d-flex","justify-content-between","mb-3"],[1,"m-0"],[1,"fa","fa-map-marker-alt","text-primary","mr-2"],[1,"fa","fa-calendar-alt","text-primary","mr-2"],["href","",1,"h5","text-decoration-none"],[1,"border-top","mt-4","pt-4"],["title","EDITAR",1,"m-0",3,"click"],[1,"fa","fa-edit","text-success","mr-2"],["title","ELIMINAR",1,"m-0",3,"click"],[1,"fas","fa-trash-alt","text-danger"],[1,"text-center","mb-3"],["controls","",1,"rounded","shadow",2,"max-height","300px","width","100%",3,"src"],[1,"col-12","text-center","p-5"],[1,"btn","btn-primary","mt-3",3,"click"]],template:function(i,t){i&1&&(o(0,"div",0),m(1,"app-sidebar"),o(2,"div",1)(3,"div",2),m(4,"app-topbar"),o(5,"div",3)(6,"div",4)(7,"h1",5),l(8,"Lista de Videos"),n()(),o(9,"div",6)(10,"div",7)(11,"div",8)(12,"form",9),u("submit",function(a){return t.buscarVideos(a)}),o(13,"div",10)(14,"span",11),m(15,"i",12),n(),o(16,"input",13),x("ngModelChange",function(a){return b(t.busquedaTitulo,a)||(t.busquedaTitulo=a),a}),n()(),o(17,"div",14)(18,"div",15)(19,"label",16),l(20,"Desde"),n(),o(21,"input",17),x("ngModelChange",function(a){return b(t.fechaDesde,a)||(t.fechaDesde=a),a}),n()(),o(22,"div",15)(23,"label",18),l(24,"Hasta"),n(),o(25,"input",19),x("ngModelChange",function(a){return b(t.fechaHasta,a)||(t.fechaHasta=a),a}),n()(),o(26,"div",20)(27,"button",21),l(28,"Buscar"),n(),o(29,"button",22),u("click",function(){return t.limpiarFiltros()}),l(30,"Limpiar"),n()()()()(),o(31,"div",23),g(32,Z,23,5,"div",24),n(),g(33,$,6,0,"div",25),m(34,"mat-paginator",26),n()()()(),m(35,"app-footer"),n()()),i&2&&(s(16),_("ngModel",t.busquedaTitulo),s(5),_("ngModel",t.fechaDesde),s(4),_("ngModel",t.fechaHasta),s(7),p("ngForOf",t.videos),s(),p("ngIf",t.videos.length===0),s(),p("length",100)("pageSize",10)("pageSizeOptions",T(8,X)))},dependencies:[Q,J,K,B,R,z,U,G,P,L,D,I,A,W,k,H,q,O,N]})}}return d})();export{ge as ListaVideoComponent};
