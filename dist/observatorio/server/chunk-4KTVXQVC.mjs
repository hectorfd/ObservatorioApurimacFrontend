import './polyfills.server.mjs';
import{c as U,f as P,g as G}from"./chunk-EJZQSUXC.mjs";import"./chunk-ZASAXBQR.mjs";import{f as R,h as z}from"./chunk-G3U6UHYZ.mjs";import{a as J,b as K,c as Q}from"./chunk-MPHLS436.mjs";import{b as j}from"./chunk-HAKE4BKR.mjs";import{c as B}from"./chunk-KKRHTJMI.mjs";import"./chunk-ACR4XYDT.mjs";import"./chunk-24XWOOB4.mjs";import"./chunk-NE3AAHS4.mjs";import{a as k,d as H,e as q,g as V,i as O,j as W,q as A}from"./chunk-PQCZKNIO.mjs";import{o as F}from"./chunk-CGZW3GIW.mjs";import{Cb as d,Dc as D,Eb as u,Ec as I,Hc as L,Nb as l,Ob as M,Pb as g,Qa as S,Rb as b,Sb as _,Ta as s,Tb as N,Ua as v,Vb as E,Wb as T,ea as C,ib as x,kb as p,ma as f,na as h,tb as i,ub as n,vb as c,zb as w}from"./chunk-MZ6UPJ7C.mjs";import"./chunk-VVCT4QZE.mjs";var X=()=>[5,10,25,100];function Y(m,y){if(m&1){let e=w();i(0,"div",27)(1,"div",28),c(2,"img",29),i(3,"div",30)(4,"div",31)(5,"small",32),c(6,"i",33),l(7),n(),i(8,"small",32),c(9,"i",34),l(10),n()(),i(11,"a",35),l(12),n(),i(13,"div",36)(14,"p"),l(15),n(),i(16,"div",31)(17,"small",37),d("click",function(){let t=f(e).$implicit,r=u();return h(r.redireccionarEditarNoticia(t.id))}),c(18,"i",38),l(19," EDITAR "),n(),i(20,"small",39),d("click",function(){let t=f(e).$implicit,r=u();return h(r.eliminarNoticia(t.id))}),c(21,"i",40),l(22," ELIMINAR "),n()()()()()()}if(m&2){let e=y.$implicit,a=u();s(2),p("src",a.getImageUrl(e.portada),S),s(5),g(" ",e.lugar,""),s(3),g(" ",e.fecha,""),s(2),M(e.titulo),s(3),g(" ",e.descripcion," ")}}function Z(m,y){if(m&1){let e=w();i(0,"div",23)(1,"div",41)(2,"h4"),l(3,"No se encontraron noticias con los filtros aplicados"),n(),i(4,"button",42),d("click",function(){f(e);let t=u();return h(t.limpiarFiltros())}),l(5,"Ver todas las noticias"),n()()()}}var he=(()=>{class m{constructor(e,a){this.router=e,this.api=a,this.noticias=[],this.allNoticias=[],this.busquedaTitulo="",this.fechaDesde="",this.fechaHasta=""}redireccionarEditarNoticia(e){this.router.navigate(["/editar-noticia",e])}ngOnInit(){this.cargarNoticias()}cargarNoticias(){this.api.getAllNoticias(1).subscribe({next:e=>{this.noticias=e,this.allNoticias=e,console.log("Noticias cargadas:",this.noticias)},error:e=>{console.error("Error al cargar noticias:",e)}})}getImageUrl(e){return e?e.startsWith("http://")||e.startsWith("https://")?e:`http://localhost:80/API OBSERVATORIO/${e}`:"assets/img/no-image.jpg"}eliminarNoticia(e){confirm("\xBFEst\xE1s seguro de que deseas eliminar esta noticia?")&&this.api.deleteNoticia(e).subscribe({next:a=>{console.log("Noticia eliminada correctamente"),this.cargarNoticias()},error:a=>{console.error("Error al eliminar la noticia:",a)}})}buscarNoticias(e){e.preventDefault();let a=[...this.allNoticias];if(this.busquedaTitulo&&this.busquedaTitulo.trim()!==""){let t=this.busquedaTitulo.toLowerCase().trim();a=a.filter(r=>r.titulo.toLowerCase().includes(t))}if(this.fechaDesde){let t=new Date(this.fechaDesde);t.setHours(0,0,0,0),a=a.filter(r=>new Date(r.fecha)>=t)}if(this.fechaHasta){let t=new Date(this.fechaHasta);t.setHours(23,59,59,999),a=a.filter(r=>new Date(r.fecha)<=t)}this.noticias=a,console.log("B\xFAsqueda realizada:",{titulo:this.busquedaTitulo,desde:this.fechaDesde,hasta:this.fechaHasta,resultados:this.noticias.length})}limpiarFiltros(){this.busquedaTitulo="",this.fechaDesde="",this.fechaHasta="",this.noticias=[...this.allNoticias]}static{this.\u0275fac=function(a){return new(a||m)(v(F),v(j))}}static{this.\u0275cmp=C({type:m,selectors:[["app-lista-noticia"]],standalone:!0,features:[E],decls:36,vars:9,consts:[["id","wrapper",1,"d-flex"],["id","content-wrapper",1,"d-flex","flex-column","w-100",2,"height","100vh","overflow-y","auto"],["id","content",1,"d-flex","flex-column","w-100"],[1,"container-fluid"],[1,"d-sm-flex","align-items-center","justify-content-between","mb-4"],[1,"h3","mb-0","text-gray-800"],[1,"container-fluid","py-5"],[1,"container"],[1,"container","my-4"],[1,"bg-white","p-4","rounded","shadow-sm",3,"submit"],[1,"input-group","mb-3"],["id","basic-addon1",1,"input-group-text"],[1,"fa","fa-file-alt","text-primary"],["type","text","placeholder","Buscar publicaci\xF3n... (opcional)","aria-label","Buscar publicaci\xF3n...","aria-describedby","basic-addon1","name","busquedaTitulo",1,"form-control",3,"ngModelChange","ngModel"],[1,"row","g-3"],[1,"col-md-4"],["for","fechaDesde",1,"form-label"],["type","date","id","fechaDesde","name","fechaDesde",1,"form-control",3,"ngModelChange","ngModel"],["for","fechaHasta",1,"form-label"],["type","date","id","fechaHasta","name","fechaHasta",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-4","d-flex","align-items-end"],["type","submit",1,"btn","btn-primary","me-2"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"row"],["class","col-lg-4 col-md-6 mb-4",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],["aria-label","Select page",3,"length","pageSize","pageSizeOptions"],[1,"col-lg-4","col-md-6","mb-4"],[1,"package-item","bg-white","mb-2"],["alt","",1,"img-fluid",3,"src"],[1,"p-4"],[1,"d-flex","justify-content-between","mb-3"],[1,"m-0"],[1,"fa","fa-map-marker-alt","text-primary","mr-2"],[1,"fa","fa-calendar-alt","text-primary","mr-2"],["href","",1,"h5","text-decoration-none"],[1,"border-top","mt-4","pt-4"],["title","EDITAR",1,"m-0",3,"click"],[1,"fa","fa-edit","text-success","mr-2"],["title","ELIMINAR",1,"m-0",3,"click"],[1,"fas","fa-trash-alt","text-danger"],[1,"col-12","text-center","p-5"],[1,"btn","btn-primary","mt-3",3,"click"]],template:function(a,t){a&1&&(i(0,"div",0),c(1,"app-sidebar"),i(2,"div",1)(3,"div",2),c(4,"app-topbar"),i(5,"div",3)(6,"div",4)(7,"h1",5),l(8,"Lista de Noticias"),n()(),i(9,"div",6)(10,"div",7)(11,"div",8)(12,"form",9),d("submit",function(o){return t.buscarNoticias(o)}),i(13,"div",10)(14,"span",11),c(15,"i",12),n(),i(16,"input",13),N("ngModelChange",function(o){return _(t.busquedaTitulo,o)||(t.busquedaTitulo=o),o}),n()(),i(17,"div",14)(18,"div",15)(19,"label",16),l(20,"Desde"),n(),i(21,"input",17),N("ngModelChange",function(o){return _(t.fechaDesde,o)||(t.fechaDesde=o),o}),n()(),i(22,"div",15)(23,"label",18),l(24,"Hasta"),n(),i(25,"input",19),N("ngModelChange",function(o){return _(t.fechaHasta,o)||(t.fechaHasta=o),o}),n()(),i(26,"div",20)(27,"button",21),l(28,"Buscar"),n(),i(29,"button",22),d("click",function(){return t.limpiarFiltros()}),l(30,"Limpiar"),n()()()()(),i(31,"div",23),x(32,Y,23,5,"div",24),n(),x(33,Z,6,0,"div",25),c(34,"mat-paginator",26),n()()(),c(35,"app-footer"),n()()()),a&2&&(s(16),b("ngModel",t.busquedaTitulo),s(5),b("ngModel",t.fechaDesde),s(4),b("ngModel",t.fechaHasta),s(7),p("ngForOf",t.noticias),s(),p("ngIf",t.noticias.length===0),s(),p("length",100)("pageSize",10)("pageSizeOptions",T(8,X)))},dependencies:[Q,J,K,B,R,z,U,G,P,L,D,I,A,W,k,H,q,O,V]})}}return m})();export{he as ListaNoticiaComponent};
