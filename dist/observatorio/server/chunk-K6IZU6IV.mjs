import './polyfills.server.mjs';
import{a as T,b as k,c as L}from"./chunk-MPHLS436.mjs";import{b as j}from"./chunk-HAKE4BKR.mjs";import{a as y,d as C,e as A,f as I,h as l,j as F,k as R,l as D,p as N,r as U}from"./chunk-PQCZKNIO.mjs";import{l as w,o as S}from"./chunk-CGZW3GIW.mjs";import{Cb as u,Eb as v,Ec as _,Hc as x,Nb as n,Qa as b,Ta as m,Ua as s,Vb as E,ea as g,ib as h,kb as c,tb as r,ub as a,vb as o}from"./chunk-MZ6UPJ7C.mjs";import{a as f}from"./chunk-VVCT4QZE.mjs";function G(d,V){if(d&1&&(r(0,"div",28),o(1,"img",29),a()),d&2){let e=v();m(),c("src",e.imagenURL,b)}}var X=(()=>{class d{mostrarImagen(e){let i=e.target.files[0];if(i){let t=new FileReader;t.onload=()=>{this.imagenURL=t.result},t.readAsDataURL(i)}}constructor(e,i,t){this.route=e,this.api=i,this.router=t,this.imagenURL=null,this.formulario=new I({id_entidad_aliada:new l(""),nombre:new l(""),descripcion:new l(""),fecha_registro:new l(""),portada:new l(""),token:new l("")})}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");console.log("ID recibido:",e),this.getDetalleEntidadAliada(e)}getDetalleEntidadAliada(e){this.api.getDetalleEntidadAliada(e).subscribe({next:i=>{console.log("Detalles de la entidad aliada:",i);let t=i[0],p=this.getToken();this.formulario.patchValue({id_entidad_aliada:t.id_entidad_aliada,nombre:t.nombre,descripcion:t.descripcion,fecha_registro:t.fecha_registro,portada:t.portada,token:p}),this.imagenURL=this.getImageUrl(t.portada)},error:i=>{console.error("Error al cargar detalles de la entidad_aliada:",i)}}),console.log(this.formulario.value.id_entidad_aliada)}getToken(){return typeof window<"u"&&window.localStorage?localStorage.getItem("token"):null}getImageUrl(e){return e?e.startsWith("http://")||e.startsWith("https://")?e:`http://localhost:80/API OBSERVATORIO/${e}`:"assets/img/no-image.jpg"}putForm(e){let i=f({},e);this.api.putEntidadAliada(i).subscribe(t=>{this.router.navigate(["/lista-entidad-aliada"])})}static{this.\u0275fac=function(i){return new(i||d)(s(w),s(j),s(S))}}static{this.\u0275cmp=g({type:d,selectors:[["app-editar-entidad-aliada"]],standalone:!0,features:[E],decls:41,vars:2,consts:[["id","wrapper",1,"d-flex"],["id","content-wrapper",1,"d-flex","flex-column","w-100"],["id","content",1,"d-flex","flex-column","w-100"],[1,"container-fluid"],[1,"d-sm-flex","align-items-center","justify-content-between","mb-4"],[1,"h3","mb-0","text-gray-800"],[1,"row"],[1,"col-lg-9","mb-4","mx-auto"],[1,"card","shadow","mb-4"],[1,"card-header","py-3","bg-primary","text-white"],[1,"m-0","font-weight-bold"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"row","mb-3"],[1,"col-md-6"],["for","fecha",1,"form-label"],["type","date","id","fecha","formControlName","fecha_registro","required","",1,"form-control"],["for","nombre",1,"form-label"],["type","text","id","nombre","placeholder","Ej: Municipalidad de Abancay","formControlName","nombre","required","",1,"form-control"],[1,"mb-3"],["for","descripcion",1,"form-label"],["id","descripcion","rows","4","placeholder","Escribe una descripci\xF3n de la entidad aliada...","formControlName","descripcion","required","",1,"form-control"],["for","portada",1,"form-label"],["type","file","id","portada","accept","image/*",1,"form-control",3,"change"],[1,"text-muted"],["class","text-center mb-3",4,"ngIf"],[1,"d-flex","justify-content-end"],["type","submit",1,"btn","btn-primary"],[1,"text-center","mb-3"],["alt","Previsualizaci\xF3n",1,"img-fluid","rounded","shadow",2,"max-height","250px",3,"src"]],template:function(i,t){i&1&&(r(0,"div",0),o(1,"app-sidebar"),r(2,"div",1)(3,"div",2),o(4,"app-topbar"),r(5,"div",3)(6,"div",4)(7,"h1",5),n(8,"Editar Infografia"),a()(),r(9,"div",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"h5",10),n(14,"Registrar Nueva Infografia"),a()(),r(15,"div",11)(16,"form",12),u("ngSubmit",function(){return t.putForm(t.formulario.value)}),r(17,"div",13)(18,"div",14)(19,"label",15),n(20,"Fecha de Registro"),a(),o(21,"input",16),a(),r(22,"div",14)(23,"label",17),n(24,"Nombre"),a(),o(25,"input",18),a()(),r(26,"div",19)(27,"label",20),n(28,"Descripci\xF3n"),a(),o(29,"textarea",21),a(),r(30,"div",19)(31,"label",22),n(32,"Foto de Portada"),a(),r(33,"input",23),u("change",function(M){return t.mostrarImagen(M)}),a(),r(34,"small",24),n(35,"Deja este campo vac\xEDo si no deseas cambiar la imagen actual"),a()(),h(36,G,2,1,"div",25),r(37,"div",26)(38,"button",27),n(39,"Actualizar Entidad Aliada"),a()()()()()()()()(),o(40,"app-footer"),a()()),i&2&&(m(16),c("formGroup",t.formulario),m(20),c("ngIf",t.imagenURL))},dependencies:[k,L,T,x,_,U,F,y,C,A,N,R,D]})}}return d})();export{X as EditarEntidadAliadaComponent};
