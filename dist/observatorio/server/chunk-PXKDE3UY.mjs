import './polyfills.server.mjs';
import{a as T,b as I,c as U}from"./chunk-MPHLS436.mjs";import{b as L}from"./chunk-HAKE4BKR.mjs";import{a as w,b as d,d as E,e as y,f as V,h as m,j as _,k as N,l as q,p as D,r as R}from"./chunk-PQCZKNIO.mjs";import{o as S}from"./chunk-CGZW3GIW.mjs";import{Cb as f,Eb as g,Ec as C,Hc as F,Nb as a,Qa as h,Ta as s,Ua as u,Vb as x,ea as v,ib as b,kb as c,tb as i,ub as t,vb as n}from"./chunk-MZ6UPJ7C.mjs";import"./chunk-VVCT4QZE.mjs";function G(l,k){if(l&1&&(i(0,"div",29),n(1,"video",30),t()),l&2){let o=g();s(),c("src",o.videoURL,h)}}var W=(()=>{class l{constructor(o,e){this.api=o,this.router=e,this.videoURL=null,this.videoForm=new V({fecha:new m("",d.required),lugar:new m("",d.required),titulo:new m("",d.required),descripcion:new m("",d.required),portada:new m("",d.required)})}mostrarVideo(o){let e=o.target;if(e.files&&e.files[0]){let r=e.files[0];this.videoFile=r;let p=new FileReader;p.onload=()=>{this.videoURL=p.result,this.videoForm.patchValue({portada:r.name})},p.readAsDataURL(r)}}registrarVideo(){if(this.videoForm.valid&&this.videoFile){let o=localStorage.getItem("token");if(!o){console.error("No se encontr\xF3 el token");return}let e=new FormData;e.append("titulo",this.videoForm.controls.titulo.value||""),e.append("descripcion",this.videoForm.controls.descripcion.value||""),e.append("fecha",this.videoForm.controls.fecha.value||""),e.append("lugar",this.videoForm.controls.lugar.value||""),e.append("portada",this.videoFile,this.videoFile.name),e.append("token",o),this.api.postVideo(e).subscribe(()=>{this.router.navigate(["/lista-video"])},r=>{console.error("Error al registrar el video",r)})}}static{this.\u0275fac=function(e){return new(e||l)(u(L),u(S))}}static{this.\u0275cmp=v({type:l,selectors:[["app-crear-video"]],standalone:!0,features:[x],decls:43,vars:2,consts:[["id","wrapper",1,"d-flex"],["id","content-wrapper",1,"d-flex","flex-column","w-100",2,"height","100vh","overflow-y","auto"],["id","content",1,"d-flex","flex-column","w-100"],[1,"container-fluid"],[1,"d-sm-flex","align-items-center","justify-content-between","mb-4"],[1,"h3","mb-0","text-gray-800"],[1,"row"],[1,"col-lg-9","mb-4","mx-auto"],[1,"card","shadow","mb-4"],[1,"card-header","py-3","bg-primary","text-white"],[1,"m-0","font-weight-bold"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"row","mb-3"],[1,"col-md-6"],["for","fecha",1,"form-label"],["type","date","id","fecha","formControlName","fecha","required","",1,"form-control"],["for","lugar",1,"form-label"],["type","text","id","lugar","placeholder","Ej: Lima, Per\xFA","formControlName","lugar","required","",1,"form-control"],[1,"mb-3"],["for","titulo",1,"form-label"],["type","text","id","titulo","placeholder","T\xEDtulo del video","formControlName","titulo","required","",1,"form-control"],["for","descripcion",1,"form-label"],["id","descripcion","rows","4","placeholder","Escribe aqu\xED los detalles del video...","formControlName","descripcion","required","",1,"form-control"],["for","video",1,"form-label"],["type","file","id","video","accept","video/*","required","",1,"form-control",3,"change"],["class","text-center mb-3",4,"ngIf"],[1,"d-flex","justify-content-end"],["type","submit",1,"btn","btn-primary"],[1,"text-center","mb-3"],["controls","",1,"rounded","shadow",2,"max-height","300px","width","100%",3,"src"]],template:function(e,r){e&1&&(i(0,"div",0),n(1,"app-sidebar"),i(2,"div",1)(3,"div",2),n(4,"app-topbar"),i(5,"div",3)(6,"div",4)(7,"h1",5),a(8,"Subir Nuevo Video"),t()(),i(9,"div",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"h5",10),a(14,"Registrar Nuevo Video"),t()(),i(15,"div",11)(16,"form",12),f("ngSubmit",function(){return r.registrarVideo()}),i(17,"div",13)(18,"div",14)(19,"label",15),a(20,"Fecha"),t(),n(21,"input",16),t(),i(22,"div",14)(23,"label",17),a(24,"Lugar"),t(),n(25,"input",18),t()(),i(26,"div",19)(27,"label",20),a(28,"T\xEDtulo"),t(),n(29,"input",21),t(),i(30,"div",19)(31,"label",22),a(32,"Descripci\xF3n"),t(),n(33,"textarea",23),t(),i(34,"div",19)(35,"label",24),a(36,"Subir Video"),t(),i(37,"input",25),f("change",function(j){return r.mostrarVideo(j)}),t()(),b(38,G,2,1,"div",26),i(39,"div",27)(40,"button",28),a(41,"Registrar Video"),t()()()()()()()()(),n(42,"app-footer"),t()()),e&2&&(s(16),c("formGroup",r.videoForm),s(22),c("ngIf",r.videoURL))},dependencies:[I,U,T,F,C,R,_,w,E,y,D,N,q]})}}return l})();export{W as CrearVideoComponent};
